<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="599px" preserveAspectRatio="none" style="width:896px;height:599px;" version="1.1" viewBox="0 0 896 599" width="896px" zoomAndPan="magnify"><defs><filter height="300%" id="fdf9hef" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#fdf9hef)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="303.5" y="281.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="310.5" y="301.5186">Resource Server</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="36" x2="36" y1="54.5938" y2="544.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="369.5" x2="369.5" y1="314.1719" y2="544.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="678.5" x2="678.5" y1="54.5938" y2="544.8828"/><rect fill="#FEFECE" filter="url(#fdf9hef)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="8" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="15" y="39.292">Client</text><rect fill="#FEFECE" filter="url(#fdf9hef)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="8" y="543.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="15" y="563.8779">Client</text><rect fill="#FEFECE" filter="url(#fdf9hef)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="303.5" y="543.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="310.5" y="563.8779">Resource Server</text><rect fill="#FEFECE" filter="url(#fdf9hef)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="600.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="666.5" y="22.9951">AM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="607.5" y="39.292">Authorization Server</text><rect fill="#FEFECE" filter="url(#fdf9hef)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="600.5" y="543.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="21" x="666.5" y="563.8779">AM</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="607.5" y="580.1748">Authorization Server</text><rect fill="#EEEEEE" filter="url(#fdf9hef)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="888" x="3" y="85.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="891" y1="85.1602" y2="85.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="891" y1="88.1602" y2="88.1602"/><rect fill="#EEEEEE" filter="url(#fdf9hef)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="173" x="360.5" y="74.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="366.5" y="90.6606">Obtain Access Token</text><polygon fill="#A80036" points="667,124.7266,677,128.7266,667,132.7266,671,128.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="673" y1="128.7266" y2="128.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="43.5" y="123.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="56.5" y="123.7935">Request access token over mTLS</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="679" x2="721" y1="173.125" y2="173.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="721" x2="721" y1="173.125" y2="186.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="680" x2="721" y1="186.125" y2="186.125"/><polygon fill="#A80036" points="690,182.125,680,186.125,690,190.125,686,186.125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="686" y="160.4927">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="699" y="152.9263">Embed client certificate hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="699" y="168.0591">into access token</text><polygon fill="#A80036" points="47.5,226.125,37.5,230.125,47.5,234.125,43.5,230.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="678" y1="230.125" y2="230.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="53.5" y="217.7583">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="66.5" y="210.1919">Return access token as JWT (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="78" x="249.5" y="210.1919">client-based</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="327.5" y="210.1919">)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="66.5" y="225.3247">or access token ID (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="193.5" y="225.3247">CTS-based</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="262.5" y="225.3247">)</text><rect fill="#EEEEEE" filter="url(#fdf9hef)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="888" x="3" y="258.957"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="891" y1="258.957" y2="258.957"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="891" y1="261.957" y2="261.957"/><rect fill="#EEEEEE" filter="url(#fdf9hef)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="157" x="368.5" y="248.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="374.5" y="264.4575">Access a Resource</text><polygon fill="#A80036" points="291.5,313.5234,301.5,317.5234,291.5,321.5234,295.5,317.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="36.5" x2="297.5" y1="317.5234" y2="317.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="43.5" y="305.1567">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="56.5" y="297.5903">Present JWT / access token ID with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="56.5" y="312.7231">embedded certificate hash over TLS</text><rect fill="#FEFECE" filter="url(#fdf9hef)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="303.5" y="281.5234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="310.5" y="301.5186">Resource Server</text><rect fill="none" height="76.5313" style="stroke: #000000; stroke-width: 2.0;" width="474" x="293.5" y="333.8203"/><polygon fill="#EEEEEE" points="293.5,333.8203,446.5,333.8203,446.5,340.8203,436.5,350.8203,293.5,350.8203,293.5,333.8203" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="308.5" y="346.8872">If CTS-based...</text><polygon fill="#A80036" points="381,397.9531,371,401.9531,381,405.9531,377,401.9531" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="667,397.9531,677,401.9531,667,405.9531,671,401.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="375" x2="673" y1="401.9531" y2="401.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="387" y="382.1528">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="400" y="367.02">Introspect access</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="400" y="382.1528">token ID to validate</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="64" x="528" y="382.1528">x5t#S256</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="596" y="382.1528">hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="400" y="397.2856">against client's TLS certificate</text><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="390.5" x="293.5" y="424.3516"/><polygon fill="#EEEEEE" points="293.5,424.3516,461.5,424.3516,461.5,431.3516,451.5,441.3516,293.5,441.3516,293.5,424.3516" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="308.5" y="437.4185">If Client-based...</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="370" x2="412" y1="477.75" y2="477.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412" x2="412" y1="477.75" y2="490.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="371" x2="412" y1="490.75" y2="490.75"/><polygon fill="#A80036" points="381,486.75,371,490.75,381,494.75,377,490.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="377" y="465.1177">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="390" y="457.5513">Read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="64" x="426" y="457.5513">x5t#S256</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="494" y="457.5513">hash from the access token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="390" y="472.6841">to validate it against client's TLS certificate</text><polygon fill="#A80036" points="47.5,522.75,37.5,526.75,47.5,530.75,43.5,526.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="41.5" x2="369" y1="526.75" y2="526.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="53.5" y="521.8169">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="66.5" y="521.8169">Allow access to protected resource</text></g></svg>